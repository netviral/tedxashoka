<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
   <p><span><span>System Architecture</span></span></p><p> </p><p><span><span><strong>Introduction</strong></span></span></p><p><span><span>Following is the architecture of the Honeynet framework by Sequretek pvt ltd. It consists of Honeypots, an interacting API, and a central database. A live HoneyMap helps visualize attackers in real time based on geolocations.</span></span></p><p> </p><p><span><span><strong>Honeypots</strong></span></span></p><p><span><span>Yellow and Black are the sensors (honeypots) sensing threats in the environment. They are: </span></span></p><p> </p><ol><li><span><span><strong>Zimbra Admin</strong></span><span>:</span></span></li></ol><p><span><span>A clone admin page for email management (Zimbra) that Sequretek uses. This captures IP address, user agent, coordinates, ISP, ASN, ASName, city, country, mobile, proxy, hosting, username and password entered. </span></span></p><p> </p><ol><li><span><span><strong>SMA Lab</strong></span><span>: </span></span></li></ol><p><span><span>A general page that exposes the IP to be scanned. </span></span></p><p> </p><ol><li><span><span><strong>CPanel</strong></span><span>:</span></span></li></ol><p><span><span>A wordpress login clone that captures IP address, user agent, coordinates, ISP, ASN, ASName, city, country, mobile, proxy, hosting, username and password entered. </span></span></p><p> </p><ol><li><span><span><strong>Mailtrail</strong></span><span>:</span></span></li></ol><p><span><span>Mailtrail is a malicious traffic detection system by </span></span><a target="_blank" href="https://github.com/stamparm/maltrail"><span><span><u>stamparm</u></span></span></a><span><span>. The ports of static ip 106.201.239.143 are opened and forwarded internally to mailtrail that senses attacks and registers them. </span></span></p><p> </p><ol><li><span><span><strong>Artillery</strong></span><span>:</span></span></li></ol><p><a target="_blank" href="https://github.com/BinaryDefense/artillery"><span><span><u>Artillery</u></span></span></a><span><span> is yet another honeypot sensing for potential attackers. </span></span></p><p> </p><p><span><span><strong>API</strong></span></span></p><p><span><span>Shown in red is the Honey API. The Honey API is the interacting later between the database and the deployed honeypots. It is language independent and can be called by any standard http client. Examples are shown below: </span></span></p><p><span><span>Eg. POST data in the database:</span></span></p><p> </p><p><span><span>Client-Side Javascript: </span></span></p><div><figure><table><colgroup><col></col></colgroup><tbody><tr><td><p><span><span>$.ajax({</span></span><br /><span><span>url: </span></span><span><span>"http://106.201.239.143:2349/api?key=&lt;pvt_key&gt;"</span></span><br /><span><span>type: </span></span><span><span>"</span></span><span><span>POST</span></span><span><span>"</span></span><span><span>, </span></span><br /><span><span>data: `{</span></span><span><span>"name"</span></span><span><span>:</span></span><span><span>"zimbra"</span></span><span><span>,</span></span><span><span>"port"</span></span><span><span>:</span></span><span><span>80</span></span><span><span>,</span></span><span><span>"ip"</span></span><span><span>:</span></span><span><span>"103.202.101.90"</span></span><span><span>}` </span></span></p></td></tr></tbody></table></figure></div><p> </p><p><span><span>Server-Side NodeJS:</span></span></p><div><figure><table><colgroup><col></col></colgroup><tbody><tr><td><p><span><span>axios.post(</span></span><span><span>"http://106.201.239.143:2349/api?key=&lt;pvt_key&gt;"</span></span><span><span>, {</span></span><br /><span><span>      </span></span><span><span>"name"</span></span><span><span>:</span></span><span><span>"zimbra"</span></span><span><span>,</span></span></p><p><span><span>       "port"</span></span><span><span>:</span></span><span><span>80</span></span><span><span>,</span></span></p><p><span><span>       "ip"</span></span><span><span>:</span></span><span><span>"103.202.101.90"</span></span><br /><span><span>  })</span></span><br /><span><span>  .</span></span><span><span>then</span></span><span><span>(</span></span><span><span>function</span></span><span><span>(response) {</span></span><br /><span><span>    console.</span></span><span><span>log</span></span><span><span>(response);</span></span><br /><span><span>  })</span></span></p></td></tr></tbody></table></figure><p> </p></div><p><span><span>Python:</span></span></p><div><figure><table><colgroup><col></col></colgroup><tbody><tr><td><p><span><span>url</span></span><span><span> = </span></span><span><span>"http://106.201.239.143:2349/api?key=&lt;pvt_key&gt;"</span></span></p><p><span><span>data</span></span><span><span> = {</span></span><span><span>"name"</span></span><span><span>:</span></span><span><span>"zimbra"</span></span><span><span>,</span></span><span><span>"port"</span></span><span><span>:</span></span><span><span>80</span></span><span><span>,</span></span><span><span>"ip"</span></span><span><span>:</span></span><span><span>"103.202.101.90"</span></span><span><span>}</span></span><br /><span><span>x</span></span><span><span> = requests.post(url, json = </span></span><span><span>data</span></span><span><span>)</span></span></p></td></tr></tbody></table></figure></div><p> </p><p><span><span>Shell: </span></span></p><div><figure><table><colgroup><col></col></colgroup><tbody><tr><td><p><span><span>curl -X POST -H </span></span><span><span>"Content-Type: application/json"</span></span><span><span> -d </span></span><span><span>"{\"</span></span><span><span>name\</span></span><span><span>": \"</span></span><span><span>zimbra\</span></span><span><span>",\"</span></span><span><span>port\</span></span><span><span>": 80</span></span><span><span>,</span></span><span><span>\"</span></span><span><span>ip\</span></span><span><span>": \"103.202.101.90\"}"</span></span><span><span> </span></span><span><span>http://106.201.239.143:2349/api?key=&lt;pvt_key&gt;</span></span></p></td></tr></tbody></table></figure></div><p> </p><p> </p><p><span><span>Eg. </span></span></p><p><span><span>Get data from the database:</span></span></p><p> </p><p><span><span>Server-Side NodeJS:</span></span></p><div><figure><table><colgroup><col></col></colgroup><tbody><tr><td><p><span><span>axios.get(</span></span><span><span>"http://106.201.239.143:2349/api?key=&lt;pvt_key&gt;"</span></span><span><span>)</span></span><br /><span><span>  .</span></span><span><span>then</span></span><span><span>(</span></span><span><span>function</span></span><span><span>(response) {</span></span><br /><span><span>    console.</span></span><span><span>log</span></span><span><span>(response);</span></span><br /><span><span>  })</span></span></p></td></tr></tbody></table></figure></div><p> </p><p> </p><figure></figure><p><span><span>Having such an API allows database queries through a RESTful client that is independent of language and drives operations. We can hence expand on our infrastructure and add more honeypots to the same architecture while maintaining a central database. This also allows us to comfortably deploy honeypots written in any language. All we have to do is send the data in the body of POST request to the HoneyAPI at </span></span><a target="_blank" href="http://106.201.239.143:2349/api?key=pvt_key"><span><span><u>http://106.201.239.143:2349/api?key=pvt_key</u></span></span></a><span><span> using any standard http client (eg. requests (Python), axios (NodeJS), curl (shell), etc)and it does the work for us. The API also serves the data in the database in the form of JSON. In order to achieve that, we send a GET request to the database: </span></span><a target="_blank" href="http://106.201.239.143:2349/api?key=pvt_key"><span><span><u>http://106.201.239.143:2349/api?key=pvt_key</u></span></span></a><span><span>. </span></span></p><p> </p><p><span><span><strong>HoneyMap</strong></span></span></p><p><span><span>The HoneyMap visualizes attackers in </span><span><strong>real time</strong></span><span> on a World Map on the basis of geographic coordinates.  It is live at: </span></span><a target="_blank" href="http://106.201.239.143:2348/"><span><span><u>http://106.201.239.143:2348/</u></span></span></a><span><span>.  </span></span></p><p> </p><p><span><span><strong>MongoDB Database:</strong></span></span></p><p><span><span>The MongoDB database is a central database where all data about the attacks in the network are stored. It runs on localhost on port 27017 on the system 192.168.3.153.</span></span></p><p> </p><p><span><span>… More details about each component in their respective documentation. </span></span></p>
</body>
</html>